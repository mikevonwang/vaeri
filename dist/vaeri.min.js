"use strict";var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Vaeri=function(){function e(){_classCallCheck(this,e),this.state={},this.dom={},this.start()}return _createClass(e,[{key:"start",value:function(){var e=this;document.addEventListener("DOMContentLoaded",function(){e.getDOM&&(e.dom=e.processDOM(e.getDOM(),document),document.querySelectorAll("*[vaeri-template=true]").forEach(function(e){e.remove()})),e.setListeners&&e.processListeners(e.setListeners(),e.dom),e.onMount&&e.onMount()})}},{key:"processDOM",value:function(e,t,r){var i=this,n={};return Object.keys(e).forEach(function(s){var a=t.vaeri_ref?t.vaeri_ref:document,l=e[s][0],o=e[s][1];if("string"==typeof l){var c=(t.vaeri_selector?t.vaeri_selector+" ":"")+l;n[s]=new VaeriElement(i,a,c,null,r),o&&Object.assign(n[s],i.processDOM(o,n[s]),{vaeri_children:Object.keys(o)})}else{var u=(t.vaeri_selector?t.vaeri_selector+" ":"")+l[0];n[s]=new VaeriElementArray(i,a,u),o&&(n[s].forEach(function(e){Object.assign(e,i.processDOM(o,e),{vaeri_children:Object.keys(o)})}),n[s].template&&Object.assign(n[s].template,i.processDOM(o,n[s].template,!0),{vaeri_children:Object.keys(o)}))}}),n}},{key:"processListeners",value:function(e,t,r){var i=this;Object.keys(e).forEach(function(n){var s=e[n][0],a=e[n][1];null!==s&&s.length>0&&(t.length>0?t.forEach(function(e){e[n].listen(s)}):t[n]&&(t[n].listen(s),r&&(t[n].listeners=s))),a&&(i.processListeners(a,t[n]),t[n].template&&i.processListeners(a,t[n].template,!0))})}},{key:"doAction",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this.state=Object.assign({},this.state,t),this[e]){var i;(i=this[e]).call.apply(i,[this].concat(_toConsumableArray(r)))}}}]),e}(),VaeriElement=function(){function e(t,r,i,n,s){_classCallCheck(this,e),this.vaeri_self=t,this.vaeri_ref=n||r.querySelector(i),this.vaeri_selector=i,this.classList=this.vaeri_ref.classList,this.getAttribute=this.vaeri_ref.getAttribute,this.setAttribute=this.vaeri_ref.setAttribute,this.insertAdjacentHTML=this.vaeri_ref.insertAdjacentHTML.bind(this.vaeri_ref),s&&this.vaeri_ref.remove()}return _createClass(e,[{key:"listen",value:function(e,t){var r=this;e.forEach(function(e){r.vaeri_ref.addEventListener(e[0],function(i){var n=void 0!==t?t():t;e[1].call(r.vaeri_self,i,r.vaeri_ref,n)})})}},{key:"value",get:function(){return this.vaeri_ref.value},set:function(e){this.vaeri_ref.value=e}}]),e}();function VaeriElementArray(e,t,r){var i=this;this.links=[];t.querySelectorAll(r).forEach(function(t){null===t.getAttribute("vaeri-template")?(i.links.push(i.length),i.push(new VaeriElement(e,null,r,t))):(i.template=new VaeriElement(e,null,r,t),i.parent=t.parentNode)}),this.listen=function(e){var t=this;this.listeners=e,this.forEach(function(r,i){r.listen(e,t.link.bind(t,i))})},this.populate=function(t,r){var i=this;void 0===t.length&&(t=[t]),t.forEach(function(t){var n=i.length;i.links.push(n);var s=i.clone(i.template,n);s.listen(i.listeners,i.link.bind(i,n)),i.parent.appendChild(s.vaeri_ref),i.push(s),r.call(e,t,n)})},this.clone=function(t,r){var i=this,n=new VaeriElement(e,null,t.vaeri_selector,t.vaeri_ref.cloneNode(!0));return t.vaeri_children&&t.vaeri_children.forEach(function(e){n[e]=i.clone(t[e],r),n.vaeri_ref.appendChild(n[e].vaeri_ref)}),t.listeners&&n.listen(t.listeners,this.link.bind(this,r)),n},this.remove=function(e){var t=this;this[e].vaeri_ref.remove(),this.splice(e,1),this.links.forEach(function(r,i){r===e?t.links[i]=null:r>e&&(t.links[i]-=1)})},this.link=function(e){return this.links[e]}}VaeriElementArray.prototype=Array.prototype;
//# sourceMappingURL=vaeri.min.js.map

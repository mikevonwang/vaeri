{"version":3,"sources":["vaeri.js"],"names":["Vaeri","_classCallCheck","this","state","dom","start","_this","addEventListener","getDOM","processDOM","document","querySelectorAll","forEach","c","setListeners","processListeners","onMount","element_list","parent","remove","key","context","vaeri_ref","selector","children","selector_full","vaeri_selector","is_template","Object","assign","_this2","vaeri_children","keys","VaeriElementArray","template","listener_list","_this3","listeners","length","listen","arguments","undefined","state_updates","_action_name","action_name","apply","concat","_toConsumableArray","VaeriElement","self","ref","vaeri_self","querySelector","classList","getAttribute","setAttribute","insertAdjacentHTML","bind","i","_this4","l","e","call","value","val","_this5","parentNode","populate","data","maker","_this6","new_vaeri_element","clone","push","source","_this7","target","cloneNode","child_key","elements","appendChild","prototype","Array"],"mappings":"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","file":"vaeri.min.js","sourcesContent":["class Vaeri {\n  constructor() {\n    this.state = {};\n    this.dom = {};\n    this.start();\n  }\n\n  start() {\n    document.addEventListener('DOMContentLoaded', () => {\n      if (this.getDOM) {\n        this.dom = this.processDOM(this.getDOM(), document);\n        document.querySelectorAll('*[vaeri-template=true]').forEach((c) => {\n          c.remove();\n        });\n      }\n      if (this.setListeners) {\n        this.processListeners(this.setListeners(), this.dom);\n      }\n      if (this.onMount) {\n        this.onMount();\n      }\n    });\n  }\n\n  processDOM(element_list, parent, is_template) {\n    let dom = {};\n    Object.keys(element_list).forEach((key) => {\n      const context = (parent.vaeri_ref) ? parent.vaeri_ref : document;\n      const selector = element_list[key][0];\n      const children = element_list[key][1];\n      if (typeof selector === 'string') {\n        const selector_full = ((parent.vaeri_selector) ? (parent.vaeri_selector + ' ') : '') + selector;\n        dom[key] = new VaeriElement(this, context, selector_full, null, is_template);\n        if (children) {\n          Object.assign(dom[key], this.processDOM(children, dom[key]), {\n            vaeri_children: Object.keys(children),\n          });\n        }\n      }\n      else {\n        const selector_full = ((parent.vaeri_selector) ? (parent.vaeri_selector + ' ') : '') + selector[0];\n        dom[key] = new VaeriElementArray(this, context, selector_full);\n        if (children) {\n          dom[key].forEach((c) => {\n            Object.assign(c, this.processDOM(children, c), {\n              vaeri_children: Object.keys(children),\n            });\n          });\n        }\n        if (dom[key].template) {\n          Object.assign(dom[key].template, this.processDOM(children, dom[key].template, true), {\n            vaeri_children: Object.keys(children),\n          });\n        }\n      }\n    });\n    return dom;\n  }\n\n  processListeners(listener_list, parent) {\n    Object.keys(listener_list).forEach((key) => {\n      const listeners = listener_list[key][0];\n      const children = listener_list[key][1];\n      if (listeners !== null && listeners.length > 0) {\n        if (parent.length > 0) {\n          parent.forEach((c) => {\n            c[key].listen(listeners);\n          });\n        }\n        else if (parent[key]) {\n          parent[key].listen(listeners);\n        }\n      }\n      if (children) {\n        this.processListeners(children, parent[key]);\n      }\n    });\n  }\n\n  doAction(action_name, state_updates, action_parameters = []) {\n    this.state = Object.assign({}, this.state, state_updates);\n    if (this[action_name]) {\n      this[action_name].call(this, ...action_parameters);\n    }\n  }\n\n}\n\nclass VaeriElement {\n  constructor(self, context, selector, ref, is_template) {\n    this.vaeri_self = self;\n    this.vaeri_ref = (ref) ? ref : context.querySelector(selector);\n    this.vaeri_selector = selector;\n\n    this.classList = this.vaeri_ref.classList;\n    this.getAttribute = this.vaeri_ref.getAttribute;\n    this.setAttribute = this.vaeri_ref.setAttribute;\n    this.insertAdjacentHTML = this.vaeri_ref.insertAdjacentHTML.bind(this.vaeri_ref);\n\n    if (is_template) {\n      this.vaeri_ref.remove();\n    }\n  }\n\n  listen(listeners, i) {\n    listeners.forEach((l) => {\n      this.vaeri_ref.addEventListener(l[0], (e) => {\n        l[1].call(this.vaeri_self, e, this.vaeri_ref, i);\n      });\n    });\n  }\n\n  get value() {\n    return this.vaeri_ref.value;\n  }\n  set value(val) {\n    this.vaeri_ref.value = val;\n  }\n}\n\nfunction VaeriElementArray(self, context, selector) {\n  const elements = context.querySelectorAll(selector);\n  elements.forEach((c) => {\n    if (c.getAttribute('vaeri-template') === null) {\n      this.push(new VaeriElement(self, null, selector, c));\n    }\n    else {\n      this.template = new VaeriElement(self, null, selector, c);\n      this.parent = c.parentNode;\n    }\n  });\n\n  this.listen = function(listeners) {\n    this.listeners = listeners;\n    this.forEach((c, i) => {\n      c.listen(listeners, i);\n    });\n  };\n\n  this.populate = function(data, maker) {\n    if (data.length === undefined) {\n      data = [data];\n    }\n    data.forEach((c) => {\n      let new_vaeri_element = this.clone(this.template);\n      this.parent.appendChild(new_vaeri_element.vaeri_ref);\n      this.push(new_vaeri_element);\n\n      const i = this.length - 1;\n      new_vaeri_element.listen(this.listeners, i);\n      maker.call(self, c, i);\n    });\n  };\n\n  this.clone = function(source) {\n    let target = new VaeriElement(self, null, source.vaeri_selector, source.vaeri_ref.cloneNode(true));\n    if (source.vaeri_children) {\n      source.vaeri_children.forEach((child_key) => {\n        target[child_key] = this.clone(source[child_key]);\n        target.vaeri_ref.appendChild(target[child_key].vaeri_ref);\n      });\n    }\n    return target;\n  };\n}\nVaeriElementArray.prototype = Array.prototype;\n"]}
{"version":3,"sources":["vaeri.js"],"names":["Vaeri","_classCallCheck","this","state","actions","dom","_this","document","addEventListener","getDOM","mapped_dom","Object","keys","user_dom","forEach","c","querySelector","VaeriElementArray","querySelectorAll","setListeners","listeners","undefined","length","l","bind","listen","d","i","setActions","onMount","action_name","new_state_items","new_state","assign","call","self","_this2","elements","push","key","selector","bound_listeners","x","map","populate","j","deleting_index","removeEventListener","splice","delete","prototype"],"mappings":"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","file":"vaeri.min.js","sourcesContent":["class Vaeri {\n  constructor() {\n    this.state = {};\n    this.actions = {};\n    this.dom = {};\n  }\n\n  start() {\n    document.addEventListener('DOMContentLoaded', () => {\n\n      if (this.getDOM) {\n        const user_dom = this.getDOM();\n        const mapped_dom = {};\n        Object.keys(user_dom).forEach((c) => {\n          if (typeof user_dom[c] === 'string') {\n            mapped_dom[c] = document.querySelector(user_dom[c]);\n          }\n          else {\n            mapped_dom[c] = new VaeriElementArray(this, c, user_dom[c], document.querySelectorAll(user_dom[c]));\n          }\n        });\n        this.dom = mapped_dom;\n      }\n\n      if (this.setListeners) {\n        const listeners = this.setListeners();\n        Object.keys(listeners).forEach((c) => {\n          if (this.dom[c]) {\n            if (this.dom[c].length === undefined) {\n              listeners[c].forEach((l) => {\n                this.dom[c].addEventListener(l[0], l[1].bind(this,this.dom[c],undefined));\n              });\n            }\n            else {\n              this.dom[c].listen(listeners[c]);\n              this.dom[c].forEach((d,i) => {\n                listeners[c].forEach((l) => {\n                  d.addEventListener(l[0], l[1].bind(this,d,i));\n                });\n              });\n            }\n          }\n        });\n      }\n\n      if (this.setActions) {\n        this.actions = this.setActions();\n      }\n\n      if (this.onMount) {\n        this.onMount();\n      }\n\n    });\n  }\n\n  doAction(action_name, new_state_items) {\n    const new_state = Object.assign({}, this.state, new_state_items);\n    if (this.actions[action_name]) {\n      this.actions[action_name].call(this, this.state, new_state);\n    }\n    this.state = new_state;\n  }\n\n}\n\nfunction VaeriElementArray(self, key, selector, elements) {\n  elements.forEach((c) => {\n    this.push(c);\n  });\n  this.key = key;\n  this.selector = selector;\n  this.listeners = null;\n  this.bound_listeners = null;\n\n  this.listen = (x) => {\n    this.listeners = x;\n    this.bound_listeners = this.listeners.map((c) => {\n      return ([]);\n    });\n  };\n\n  this.populate = () => {\n    this.length = 0;\n    document.querySelectorAll(this.selector).forEach((c,i) => {\n      this.push(c);\n      if (this.listeners) {\n        this.bound_listeners[i] = [];\n        this.listeners.forEach((l,j) => {\n          this.bound_listeners[i][j] = l[1].bind(self,c,i);\n          c.addEventListener(l[0], this.bound_listeners[i][j]);\n        });\n      }\n    });\n  };\n\n  this.delete = (deleting_index) => {\n    this.forEach((c,i) => {\n      if (this.listeners) {\n        this.listeners.forEach((l,j) => {\n          c.removeEventListener(l[0], this.bound_listeners[i][j]);\n        });\n      }\n    });\n    this.splice(deleting_index, 1);\n    if (this.listeners) {\n      this.bound_listeners.splice(deleting_index, 1);\n    }\n    this.forEach((c,i) => {\n      if (this.listeners) {\n        this.listeners.forEach((l,j) => {\n          this.bound_listeners[i][j] = l[1].bind(self,c,i);\n          c.addEventListener(l[0], this.bound_listeners[i][j]);\n        });\n      }\n    });\n  };\n}\nVaeriElementArray.prototype = Array.prototype;\n"]}